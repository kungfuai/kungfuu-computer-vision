
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1. Preparing an Image Dataset for Model Training &#8212; Evolve model training recipes for image classification</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. A Minimal Model Training Experiment" href="p2_training.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Evolve model training recipes for image classification</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Preparing an Image Dataset for Model Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="p2_training.html">
   2. A Minimal Model Training Experiment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="p3_dataloader.html">
   3. Efficent Data Loading for Model Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimizer.html">
   4. Effect of Optimizers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arch.html">
   5. Effect of Model Architecture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aug.html">
   6. Effect of Image Pre-processing and Augmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="loss.html">
   7. Effect of Loss Function Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="predictor.html">
   8. Wrapping up: Image Classifier as a Predictor Service
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="additional_topics.html">
   9. Optional: Selected topics on image classifiers
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="scale_experiments.html">
     9.1. Efficient Experiments: Scale to Hundreds of Experiments
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="self_supervised.html">
     9.2. Self Supervised Learning as a Pre-train Step for Image Classification
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="self_supervised/solo_learn.html">
       9.2.1. Self Supervised Learning and Linear Probing on CIFAR10
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multitask.html">
     9.3. Multi-task Learning for Image Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bayesian.html">
     9.4. Bayesian Neural Networks for Image Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="unlearn.html">
     9.5. Adversarial Learning: Unlearn Questionable Correlations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="few_shot.html">
     9.6. Few Shot Learning: Cope with Small Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="explain.html">
     9.7. Transparancy: Explaining Model’s Prediction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="federated.html">
     9.8. Privacy: Federated Learning for Image Classification
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="keys.html">
   10. Keys to Some Projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="p1_dataset_key.html">
     10.1. Project 1: Preparing an image dataset for model training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="p2_training_key.html">
     10.2. Project 2: A minimal model training experiment
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Created at <a href="https://kungfu.ai">KUNGFU.AI</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://colab.research.google.com/github/kungfuai/kungfuu-computer-vision/blob/main/course1-image-classification/p1_dataset.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/kungfuai/kungfuu-computer-vision"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/kungfuai/kungfuu-computer-vision/issues/new?title=Issue%20on%20page%20%2Fp1_dataset.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/p1_dataset.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-1-create-a-dataset-class">
   1.1. Step 1: Create a Dataset class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-2-visualize-the-image-data">
   1.2. Step 2: Visualize the image data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-3-create-a-data-loader">
   1.3. Step 3: Create a data loader
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-images-in-a-grid-using-matplotlib">
     1.3.1. Display images in a grid using
     <code class="docutils literal notranslate">
      <span class="pre">
       matplotlib
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-4-optional-writing-unit-tests-for-your-dataset-class">
   1.4. Step 4 (optional): Writing unit tests for your dataset class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   1.5. References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Preparing an Image Dataset for Model Training</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-1-create-a-dataset-class">
   1.1. Step 1: Create a Dataset class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-2-visualize-the-image-data">
   1.2. Step 2: Visualize the image data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-3-create-a-data-loader">
   1.3. Step 3: Create a data loader
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-images-in-a-grid-using-matplotlib">
     1.3.1. Display images in a grid using
     <code class="docutils literal notranslate">
      <span class="pre">
       matplotlib
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-4-optional-writing-unit-tests-for-your-dataset-class">
   1.4. Step 4 (optional): Writing unit tests for your dataset class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   1.5. References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="preparing-an-image-dataset-for-model-training">
<h1><span class="section-number">1. </span>Preparing an Image Dataset for Model Training<a class="headerlink" href="#preparing-an-image-dataset-for-model-training" title="Permalink to this headline">#</a></h1>
<p><strong>Goal:</strong></p>
<ul class="simple">
<li><p>Implement a <a class="reference external" href="https://pytorch.org/docs/stable/data.html#map-style-datasets">map-style Dataset class</a>.</p></li>
<li><p>Implement a <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">data loader</a> that directly feeds data into model training.</p></li>
<li><p>Quality check your data, served through dataset class.</p></li>
</ul>
<p><strong>Acceptance criteria:</strong></p>
<ul class="simple">
<li><p>The Dataset class should implement <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>  and <code class="docutils literal notranslate"><span class="pre">__len__</span></code> methods, where <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> should return a training example, which is a tuple of (image, label).</p></li>
<li><p>The data loader should be iterable and returns batches of examples.</p></li>
<li><p>In a notebook, present example images, labels and ensure correct shapes by visual inspection.</p></li>
</ul>
<p><strong>Resources</strong>:</p>
<ul class="simple">
<li><p>Sample key: a notebook containing the keys of the exercises is attached <a class="reference internal" href="p1_dataset_key.html"><span class="doc std std-doc">here</span></a>.</p></li>
</ul>
<section id="step-1-create-a-dataset-class">
<h2><span class="section-number">1.1. </span>Step 1: Create a Dataset class<a class="headerlink" href="#step-1-create-a-dataset-class" title="Permalink to this headline">#</a></h2>
<p>One of the first things you may need to do in a practical project is to create a custom dataset class. As a start, let us use CIFAR10 raw data as an example to create one. First, we need to download the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Please makse sure to remove the exclamation mark if you run the commands in the terminal.</span>
<span class="o">!</span>wget https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz
<span class="o">!</span>tar -xzf cifar-10-python.tar.gz
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2022-08-11 00:54:41--  https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz
Resolving www.cs.toronto.edu (www.cs.toronto.edu)... 128.100.3.30
Connecting to www.cs.toronto.edu (www.cs.toronto.edu)|128.100.3.30|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 170498071 (163M) [application/x-gzip]
Saving to: ‘cifar-10-python.tar.gz’

cifar-10-python.tar 100%[===================&gt;] 162.60M  45.0MB/s    in 4.0s    

2022-08-11 00:54:46 (40.6 MB/s) - ‘cifar-10-python.tar.gz’ saved [170498071/170498071]
</pre></div>
</div>
</div>
</div>
<p>Inspect the downloaded raw data and folder structure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls -lht cifar-10-batches-py/
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total 178M
-rw-r--r-- 1 2156 1103  88 Jun  4  2009 readme.html
-rw-r--r-- 1 2156 1103 158 Mar 31  2009 batches.meta
-rw-r--r-- 1 2156 1103 30M Mar 31  2009 data_batch_4
-rw-r--r-- 1 2156 1103 30M Mar 31  2009 data_batch_1
-rw-r--r-- 1 2156 1103 30M Mar 31  2009 data_batch_5
-rw-r--r-- 1 2156 1103 30M Mar 31  2009 data_batch_2
-rw-r--r-- 1 2156 1103 30M Mar 31  2009 data_batch_3
-rw-r--r-- 1 2156 1103 30M Mar 31  2009 test_batch
</pre></div>
</div>
</div>
</div>
<p>The archive contains the files data_batch_1, data_batch_2, …, data_batch_5, as well as test_batch. Each of these files is a Python “pickled” object.</p>
<p>Loaded using the <code class="docutils literal notranslate"><span class="pre">unpickle</span></code> method provided below, each of the batch files contains a python dictionary with the following elements:</p>
<p><em>data</em> – a 10000x3072 numpy array of uint8s. Each row of the array stores a 32x32 colour image. The first 1024 entries contain the red channel values, the next 1024 the green, and the final 1024 the blue. The image is stored in row-major order, so that the first 32 entries of the array are the red channel values of the first row of the image.</p>
<p><em>labels</em> – a list of 10000 numbers in the range 0-9. Each number maps to a class label. For information about the 10 classes, please refer to the <a class="reference external" href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-10 website</a>.</p>
<p><strong>Your task</strong>: Fill in the missing code in the next cell, so that it can pass the test that follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>


<span class="n">CLASSES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;airplane&quot;</span><span class="p">,</span> <span class="s2">&quot;automobile&quot;</span><span class="p">,</span> <span class="s2">&quot;bird&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;deer&quot;</span><span class="p">,</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;frog&quot;</span><span class="p">,</span>
           <span class="s2">&quot;horse&quot;</span><span class="p">,</span> <span class="s2">&quot;ship&quot;</span><span class="p">,</span> <span class="s2">&quot;truck&quot;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">unpickle</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
        <span class="nb">dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;bytes&#39;</span><span class="p">)</span>
    <span class="c1"># The keys of this dic: [b&#39;batch_label&#39;, b&#39;labels&#39;, b&#39;data&#39;, b&#39;filenames&#39;]</span>
    <span class="k">return</span> <span class="nb">dict</span>


<span class="k">def</span> <span class="nf">reshape_numpy_image</span><span class="p">(</span><span class="n">one_numpy_image</span><span class="p">):</span>
    <span class="n">shape_with_channels_first</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>  <span class="c1"># (channels, height, width), channels first</span>
    <span class="n">shape_with_channels_last</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># (height, width, channels), channels last</span>
    <span class="c1"># TODO: in the next line, should we use shape_with_channels_first or shape_with_channels_last?</span>
    <span class="c1">#   It depends on how the numpy array in the raw data is stored. It is hard to know which</span>
    <span class="c1">#   whay is correct, without trying both and visualizing.</span>
    <span class="k">return</span> <span class="n">one_numpy_image</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">shape_with_channels_last</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">print_and_visualize_data</span><span class="p">():</span>
  <span class="n">data_dict</span> <span class="o">=</span> <span class="n">unpickle</span><span class="p">(</span><span class="s2">&quot;cifar-10-batches-py/data_batch_1&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="sa">b</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
  <span class="n">labels</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="sa">b</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;labels:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>


  <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="n">one_image</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
  <span class="n">reshaped_image</span> <span class="o">=</span> <span class="n">reshape_numpy_image</span><span class="p">(</span><span class="n">one_image</span><span class="p">)</span>

  <span class="c1"># imshow() requires the image to be in &quot;channels last&quot; format</span>
  <span class="c1"># So if the image is &quot;channels first&quot;, transpose it.</span>
  <span class="k">if</span> <span class="n">reshaped_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">reshaped_image</span> <span class="o">=</span> <span class="n">reshaped_image</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">reshaped_image</span><span class="p">)</span>
  <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">CLASSES</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># Uncomment the following line to visualize data.</span>
<span class="c1"># print_and_visualize_data()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span>


<span class="k">class</span> <span class="nc">CustomDataset</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;cifar-10-batches-py&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># TODO: if train is True, load the training data (data_batch_1 through 5), otherwise load the validation data (test_data_batch).</span>
        <span class="c1">#</span>
        <span class="c1"># Some snippets that may be useful:</span>
        <span class="c1">#    images = np.concatenate([images, data[b&quot;data&quot;]], axis=0)  # add more images to the existing numpy array</span>
        <span class="c1">#    labels = labels + data_dict[b&quot;labels&quot;]  # add more labels to the existing list</span>
        <span class="k">if</span> <span class="n">train</span><span class="p">:</span>
          <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">]:</span>
        <span class="o">...</span>
    
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is the test code for the class CustomDataset.</span>

<span class="k">def</span> <span class="nf">test_custom_dataset</span><span class="p">():</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">CustomDataset</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="si">}</span><span class="s2"> examples&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">50000</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Expect the training set to have 50000 examples.&quot;</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">CustomDataset</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10000</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Expect the validation set to have 10000 examples.&quot;</span>
    <span class="n">first_example</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The first example is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">first_example</span><span class="p">)</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">first_example</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements&quot;</span><span class="p">)</span>
    <span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">first_example</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The first example has an image of shape </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and label </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">label</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">label</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Label </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> is not in [0, 10)&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test passed!&quot;</span><span class="p">)</span>

<span class="n">test_custom_dataset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>If the tests works, congratulations! You have completed the first step of the project. You have implemented a dataset class similar to <code class="docutils literal notranslate"><span class="pre">torchvision.datasets.CIFAR10</span></code>.</p>
</section>
<section id="step-2-visualize-the-image-data">
<h2><span class="section-number">1.2. </span>Step 2: Visualize the image data<a class="headerlink" href="#step-2-visualize-the-image-data" title="Permalink to this headline">#</a></h2>
<p>However, passing the unit tests may not be enough. The content of the image may not make sense even if the shape is correct, depending on how the reshaping of numpy arrays is done.</p>
<p>In the next cells, display several images from the dataset together with the label. Visually check the image and the label. A helper function is provided.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">display_image_with_label</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Label: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># TODO: add code to the next cells to display at least 2 images from CustomDataset.</span>
<span class="c1"># You can use one cell for each image.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: display the first image and label</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: display the second image and label</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-create-a-data-loader">
<h2><span class="section-number">1.3. </span>Step 3: Create a data loader<a class="headerlink" href="#step-3-create-a-data-loader" title="Permalink to this headline">#</a></h2>
<p>A data loader is a class that can be used to load batches of data. It provides a way to iterate over the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, returning a batch of data at each iteration.</p>
<p>For PyTorch, we strongly recommend using the <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">torch.utils.data.DataLoader</a> class to load the data. It has a lot of built-in functionalities to handle efficient concurrent loading of data that you don’t need to implement from scratch. In our experience, it is rarely needed to implement a custom version of <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code>. Getting familar with how to use a PyTorch <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> is usually enough.</p>
<p>The figure below (source: <a class="footnote-reference brackets" href="#footcite-stevens2020learning" id="id1">1</a>) shows the relationship between a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> and a <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code>:</p>
<p><img alt="dataset and dataloader" src="https://drek4537l1klr.cloudfront.net/stevens2/Figures/CH07_F14_Stevens2_GS.png" /></p>
<p><strong>Your task</strong>: Fill in the missing code in the next cell, so that it can pass the test that follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>

<span class="c1"># TODO: fill in the code to create a data loader with a batch size of 16.</span>
<span class="n">data_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_data_loader</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">data_loader</span><span class="p">:</span>
        <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
        <span class="k">assert</span> <span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">batch_size</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Expecting a batch of </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2"> images&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;shape is </span><span class="si">{</span><span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> for the image batch&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">==</span> <span class="n">batch_size</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Expecting a batch of </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2"> labels&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The test is passed!&quot;</span><span class="p">)</span>
        <span class="k">break</span>


<span class="n">test_data_loader</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="display-images-in-a-grid-using-matplotlib">
<h3><span class="section-number">1.3.1. </span>Display images in a grid using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code><a class="headerlink" href="#display-images-in-a-grid-using-matplotlib" title="Permalink to this headline">#</a></h3>
<p>You can also display multiple images in one figure. This way you can visualize a batch of images easily. Below is a function and snippet to start with. You may need to transpose the image for display purpose.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_images</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span> <span class="o">+</span> <span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">ncols</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>


<span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data_loader</span><span class="p">))</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: visualize a batch of images</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="step-4-optional-writing-unit-tests-for-your-dataset-class">
<h2><span class="section-number">1.4. </span>Step 4 (optional): Writing unit tests for your dataset class<a class="headerlink" href="#step-4-optional-writing-unit-tests-for-your-dataset-class" title="Permalink to this headline">#</a></h2>
<p>To make sure your dataset is feeding the right data to the model, visualization is helpful, but unit tests can make certain checks more efficient.</p>
<p>You may have noticed, in previous steps unit tests such as <code class="docutils literal notranslate"><span class="pre">test_custom_dataset</span></code> are already used to check the correctness of your implementation.</p>
<p>The following types of unit tests can be written against a dataset class:</p>
<ul class="simple">
<li><p>Tests that check the functionality of the class (e.g. calling <code class="docutils literal notranslate"><span class="pre">len(dataset)</span></code> does not raise an error).</p></li>
<li><p>Tests that check the type and shape of the data returned by the class.</p></li>
<li><p>Tests that check the content of the data returned by the class.</p></li>
</ul>
<p>Below is an example unit test that checks if the shape of the image is “channels-first” (3, height, width) rather than “channels-last” (height, width, 3). PyTorch expects the image to be in “channels-first” format, while Tensorflow expects it to be “channels-last”.</p>
<p><strong>Your task</strong>: Fill in the missing code in unit test. Make necesssary changes to your dataset class to pass the test. Can you think of other tests that can answer questions about the dataset? For example, can you write a test about the maximum pixel intensity of this dataset?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_custom_dataset_returns_images_with_channels_first</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Check the shape of the image, especially the channels axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: fill in.</span>
    <span class="k">pass</span>


<span class="n">test_custom_dataset_returns_images_with_channels_first</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Congratulations!</strong> You have completed the first project of this course.</p>
</section>
<section id="references">
<h2><span class="section-number">1.5. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<div class="docutils container" id="id2">
<dl class="footnote brackets">
<dt class="label" id="footcite-stevens2020learning"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Eli Stevens, Luca Antiga, and Thomas Viehmann. <em>Deep Learning with PyTorch</em>. Manning, 2020. URL: <a class="reference external" href="https://pytorch.org/assets/deep-learning/Deep-Learning-with-PyTorch.pdf">https://pytorch.org/assets/deep-learning/Deep-Learning-with-PyTorch.pdf</a>.</p>
</dd>
</dl>
</div>
<hr class="footnotes docutils" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="p2_training.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>A Minimal Model Training Experiment</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By KUNGFU.AI<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>